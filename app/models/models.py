import datetime
from uuid import UUID
from pydantic import BaseModel, ConfigDict

# =============================
# MEDIA ROLES
# =============================
class MediaRoleBase(BaseModel):
    media_role_name: str | None = None
    description: str | None = None
    sort_order: int | None = None
    is_active: bool = True
    media_role_code: str | None = None

class MediaRoleCreate(MediaRoleBase):
    model_config = ConfigDict(extra="forbid")
    # media_role_id is auto-generated by the DB
    media_role_name: str
    # description is optional
    sort_order: int
    media_role_code: str 
    # is_active is defaulted by the DB

class MediaRoleUpdate(BaseModel):
    media_role_name: str | None = None
    description: str | None = None
    sort_order: int | None = None
    is_active: bool = True
    # media_role_code is not updatable, delete and recreate if needed

class MediaRoleOut(MediaRoleBase):
    media_role_id: UUID

# =============================
# PROFICIENCY LEVELS
# =============================
class ProficiencyLevelBase(BaseModel):
    proficiency_level_name: str | None = None
    proficiency_level_number: int | None = None
    is_active: bool = True
    proficiency_level_code: str | None = None
    is_assignable: bool = False

class ProficiencyLevelCreate(ProficiencyLevelBase):
    model_config = ConfigDict(extra="forbid")
    # proficiency_level_id is auto-generated by the DB
    proficiency_level_name: str
    # proficiency_level_number is optional
    proficiency_level_code: str 
    # is_active is defaulted by the DB
    # is_assignable is defaulted by the DB

class ProficiencyLevelUpdate(BaseModel):
    proficiency_level_name: str | None = None
    proficiency_level_number: int | None = None
    is_active: bool = True
    # proficiency_level_code is not updatable, delete and recreate if needed
    is_assignable: bool = False

class ProficiencyLevelOut(ProficiencyLevelBase):
    proficiency_level_id: UUID

# =============================
# SCHEDULE DATE TYPES
# =============================
class ScheduleDateTypeBase(BaseModel):
    schedule_date_type_name: str | None = None
    is_active: bool = True
    schedule_date_type_code: str | None = None

class ScheduleDateTypeCreate(ScheduleDateTypeBase):
    model_config = ConfigDict(extra="forbid")
    # schedule_date_type_id is auto-generated by the DB
    schedule_date_type_name: str
    schedule_date_type_code: str 
    # is_active is defaulted by the DB

class ScheduleDateTypeUpdate(BaseModel):
    schedule_date_type_name: str | None = None
    is_active: bool = True
    # schedule_date_type_code is not updatable, delete and recreate if needed

class ScheduleDateTypeOut(ScheduleDateTypeBase):
    schedule_date_type_id: UUID

# =============================
# TEAMS
# =============================
class TeamBase(BaseModel):
    team_name: str | None = None
    is_active: bool = True
    team_code: str | None = None

class TeamCreate(TeamBase):
    model_config = ConfigDict(extra="forbid")
    # team_id is auto-generated by the DB
    team_name: str
    team_code: str 
    # is_active is defaulted by the DB

class TeamUpdate(BaseModel):
    team_name: str | None = None
    is_active: bool = True
    # team_code is not updatable, delete and recreate if needed

class TeamOut(TeamBase):
    team_id: UUID

# =============================
# USERS
# =============================
class UserBase(BaseModel):
    first_name: str | None = None
    last_name: str | None = None
    email: str | None = None
    phone: str | None = None
    is_active: bool = True

class UserCreate(UserBase):
    model_config = ConfigDict(extra="forbid")
    # user_id is auto-generated by the DB
    first_name: str 
    last_name: str 
    # email is optional
    phone: str 
    # is_active is defaulted by the DB

class UserUpdate(UserBase):
    pass

class UserOut(UserBase):
    user_id: UUID

# =============================
# TEAM USERS
# =============================
class TeamUserBase(BaseModel):
    team_id: UUID | None = None
    user_id: UUID | None = None
    is_active: bool = True

class TeamUserCreate(TeamUserBase):
    model_config = ConfigDict(extra="forbid")
    # team_user_id is auto-generated by the DB
    team_id: UUID
    user_id: UUID
    # is_active is defaulted by the DB

class TeamUserUpdate(BaseModel):
    is_active: bool

class TeamUserOut(TeamUserBase):
    team_user_id: UUID

# =============================
# USER ROLES
# =============================
class UserRoleBase(BaseModel):
    user_id: UUID | None = None
    media_role_id: UUID | None = None
    proficiency_level_id: UUID | None = None

class UserRoleCreate(UserRoleBase):
    model_config = ConfigDict(extra="forbid")
    # user_role_id is auto-generated by the DB
    user_id: UUID
    media_role_id: UUID
    proficiency_level_id: UUID

class UserRoleUpdate(BaseModel):
    proficiency_level_id: UUID

class UserRoleOut(UserRoleBase):
    user_role_id: UUID

# =============================
# DATES
# =============================
class DateBase(BaseModel):
    calendar_year: int | None = None
    calendar_month: int | None = None
    month_name: str | None = None
    month_abbr: str | None = None
    calendar_day: int | None = None
    weekday: int | None = None
    weekday_name: str | None = None
    is_weekend: bool = False
    is_weekday: bool = False
    is_holiday: bool = False
    week_number: int | None = None
    is_first_of_month: bool = False
    is_last_of_month: bool = False
    calendar_quarter: int | None = None
    weekday_of_month: int | None = None 

class DateCreate(BaseModel):
    model_config = ConfigDict(extra="forbid")
    date: datetime.date
    # do not inherit from DateBase, all other fields will be automatically calculated

class DateUpdate(DateBase):
    pass

class DateOut(DateBase):
    date: datetime.date

# =============================
# SCHEDULES
# =============================
class ScheduleBase(BaseModel):
    month_start_date: datetime.date | None = None
    is_active: bool = True
    notes: str | None = None

class ScheduleCreate(ScheduleBase):
    model_config = ConfigDict(extra="forbid")
    # schedule_id is auto-generated by the DB
    month_start_date: datetime.date
    # is_active is defaulted by the DB

class ScheduleUpdate(BaseModel):
    is_active: bool = True
    notes: str | None = None

class ScheduleOut(ScheduleBase):
    schedule_id: UUID

# =============================
# SCHEDULE DATES
# =============================
class ScheduleDateBase(BaseModel):
    schedule_id: UUID | None = None
    date: datetime.date | None = None
    team_id: UUID | None = None
    schedule_date_type_id: UUID | None = None
    notes: str | None = None
    is_active: bool = True

class ScheduleDateCreate(ScheduleDateBase):
    model_config = ConfigDict(extra="forbid")
    # schedule_date_id is auto-generated by the DB
    schedule_id: UUID
    date: datetime.date
    # team_id is optional
    schedule_date_type_id: UUID
    # notes is optional
    # is_active is defaulted by the DB

class ScheduleDateUpdate(ScheduleDateBase):
    pass

class ScheduleDateOut(ScheduleDateBase):
    schedule_date_id: UUID

# =============================
# SCHEDULE DATE ROLES
# =============================
class ScheduleDateRoleBase(BaseModel):
    schedule_date_id: UUID | None = None
    media_role_id: UUID | None = None
    is_required: bool = False
    is_preferred: bool = False
    assigned_user_id: UUID | None = None
    is_active: bool = True

class ScheduleDateRoleCreate(ScheduleDateRoleBase):
    model_config = ConfigDict(extra="forbid")
    # schedule_date_role_id is auto-generated by the DB
    schedule_date_id: UUID
    media_role_id: UUID
    # is_required is defaulted by the DB
    # is_preferred is defaulted by the DB
    # assigned_user_id is optional
    # is_active is defaulted by the DB

class ScheduleDateRoleUpdate(ScheduleDateRoleBase):
    pass

class ScheduleDateRoleOut(ScheduleDateRoleBase):
    schedule_date_role_id: UUID

# =============================
# USER AVAILABILITY
# =============================
class UserAvailabilityBase(BaseModel):
    user_id: UUID | None = None
    date: datetime.date | None = None

class UserAvailabilityCreate(UserAvailabilityBase):
    model_config = ConfigDict(extra="forbid")
    # user_availability_id is auto-generated by the DB
    user_id: UUID
    date: datetime.date

class UserAvailabilityUpdate(UserAvailabilityBase):
    date: datetime.date

class UserAvailabilityOut(UserAvailabilityBase):
    user_availability_id: UUID